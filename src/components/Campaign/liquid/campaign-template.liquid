<!-- 
  Campaign liquid template for multiple rendering scenarios
  Supports simple, dynamic, and section modes with grid and carousel layouts
-->
{% if settings.mode == 'simple' or settings.mode == 'dynamic' %}
<nosto-campaign
  placement="{{ settings.campaignPlacement }}"
  {% if settings.campaignLazy %}lazy{% endif %}
  {% if settings.campaignCartSynced %}cart-synced{% endif %}
>
  <!-- Simple and Dynamic modes: uses product cards with layout-specific wrappers -->
  <div class="campaign-{{ settings.mode }}">
    <!-- Layout-specific wrapper start -->
    {% if settings.layout == 'grid' %}
      <div class="campaign-grid{% if settings.gridSize %} campaign-grid-{{ settings.gridSize }}{% endif %}">
    {% elsif settings.layout == 'carousel' %}
      <swiper-container class="campaign-carousel">
        <div class="swiper-wrapper">
    {% endif %}
    
    <!-- Single product loop -->
    {% for product in products %}
      {% if settings.layout == 'grid' %}
        <div class="campaign-grid-item">
      {% elsif settings.layout == 'carousel' %}
        <swiper-slide>
      {% endif %}
      
      <!-- Mode-specific product card -->
      {% if settings.mode == 'simple' %}
        <nosto-simple-card
          :handle="product.handle"
          {% if settings.simpleAlternate %}alternate{% endif %}
          {% if settings.simpleBrand %}brand{% endif %}
          {% if settings.simpleDiscount %}discount{% endif %}
          {% if settings.simpleRating %}rating{% endif %}
          {% if settings.simpleSizes %}sizes="{{ settings.simpleSizes }}"{% endif %}
        >
          {% if settings.variantSelector %}
            <nosto-variant-selector
              :handle="product.handle"
              {% if settings.variantSelectorPreselect %}preselect{% endif %}
            ></nosto-variant-selector>
          {% endif %}
        </nosto-simple-card>
      {% elsif settings.mode == 'dynamic' %}
        <nosto-dynamic-card
          :handle="product.handle"
          {% if settings.dynamicTemplate %}template="{{ settings.dynamicTemplate }}"{% endif %}
          {% if settings.dynamicSection %}section="{{ settings.dynamicSection }}"{% endif %}
        ></nosto-dynamic-card>
      {% endif %}
      
      {% if settings.layout == 'grid' %}
        </div>
      {% elsif settings.layout == 'carousel' %}
        </swiper-slide>
      {% endif %}
    {% endfor %}
    
    <!-- Layout-specific wrapper end -->
    {% if settings.layout == 'grid' %}
      </div>
    {% elsif settings.layout == 'carousel' %}
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
      </swiper-container>
    {% endif %}
  </div>
</nosto-campaign>
{% else %}
<!-- Section mode: uses SectionCampaign without children -->
<nosto-section-campaign
  placement="{{ settings.campaignPlacement }}"
  {% if settings.sectionCampaignSection %}section="{{ settings.sectionCampaignSection }}"{% endif %}
></nosto-section-campaign>
{% endif %}

<style>
  nosto-campaign {
    display: block;
    width: 100%;
  }
  
  .campaign-title {
    margin: 0 0 1rem 0;
    font-size: 1.5rem;
    font-weight: 600;
  }
  
  .campaign-grid {
    display: grid;
    gap: 1rem;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }
  
  .campaign-grid-1 {
    grid-template-columns: 1fr;
  }
  
  .campaign-grid-2 {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .campaign-grid-3 {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .campaign-grid-4 {
    grid-template-columns: repeat(4, 1fr);
  }
  
  .campaign-grid-5 {
    grid-template-columns: repeat(5, 1fr);
  }
  
  .campaign-grid-6 {
    grid-template-columns: repeat(6, 1fr);
  }
  
  @media (max-width: 768px) {
    .campaign-grid {
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.5rem;
    }
  }
  
  swiper-container.campaign-carousel {
    position: relative;
    padding-bottom: 2rem;
  }
  
  swiper-container.campaign-carousel swiper-slide {
    width: auto;
    min-width: 250px;
  }
  
  swiper-container.campaign-carousel .swiper-pagination {
    bottom: 0;
  }
  
  .campaign-section {
    width: 100%;
  }
</style>